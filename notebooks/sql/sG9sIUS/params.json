{
  "analyzedDataset": "FINAIADVISOR.Labeled_scored_stacked",
  "connection": "Snowflake-AWS",
  "name": "notebook editor for compute_customer_counts",
  "recipeId": "compute_customer_counts",
  "cells": [
    {
      "id": "PwMzGjVMADip",
      "type": "QUERY",
      "name": "Created from \u0027compute_customer_counts\u0027 recipe on Mon, 3 Mar 2025 18:53:34 GMT",
      "code": "SELECT *\n  FROM \"SEDEMO\".\"ERIND\".\"FINAIADVISOR_LABELED_SCORED_STACKED\"",
      "querySettings": {
        "addLimitToStatement": true,
        "statementsOutOfTransaction": false,
        "inheritConf": "default",
        "extraConf": [],
        "addDkuUdf": false,
        "statementsParseMode": "SPLIT",
        "statementsExecutionMode": "PREPARED"
      }
    },
    {
      "id": "ps35gq6cz9r",
      "type": "QUERY",
      "name": "count_customers_by_loan_purpose_for_CA",
      "code": "-- To get the count of customers by loan purpose for the state of California (CA), we need to query the \n-- table that contains both customer and loan information. The most suitable table for this is \n-- `FINAIADVISOR_CUSTOMERS_AND_LOAN` as it contains both customer details and loan purpose. We will \n-- filter the results for the state of California and group the results by `Loan_Purpose` to get the \n-- count of customers for each purpose.\nSELECT\n    \"Loan_Purpose\",\n    COUNT(*) AS \"Customer_Count\"\nFROM\n    \"SEDEMO\".\"ERIND\".\"FINAIADVISOR_CUSTOMERS_AND_LOAN\"\nWHERE\n    \"State\" \u003d \u0027CA\u0027\nGROUP BY\n    \"Loan_Purpose\"\nORDER BY\n    \"Customer_Count\" DESC;",
      "querySettings": {
        "addLimitToStatement": true,
        "statementsOutOfTransaction": false,
        "inheritConf": "default",
        "extraConf": [],
        "addDkuUdf": false,
        "statementsParseMode": "SPLIT",
        "statementsExecutionMode": "PREPARED"
      }
    }
  ],
  "automationLocal": false,
  "creationTag": {
    "versionNumber": 0,
    "lastModifiedBy": {
      "login": "admin"
    },
    "lastModifiedOn": 1741028014434
  },
  "tags": [
    "recipe-editor"
  ],
  "customFields": {},
  "checklists": {
    "checklists": []
  }
}