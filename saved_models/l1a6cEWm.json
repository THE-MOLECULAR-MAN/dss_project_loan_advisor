{
  "needsInputDataFolder": false,
  "savedModelType": "TOOLS_USING_AGENT",
  "publishPolicy": "UNCONDITIONAL",
  "rebuildBehavior": "EXPLICIT",
  "cleanTemporaryVersionsPostJob": false,
  "name": "Loan Advisor Agent",
  "activeVersion": "v1",
  "inlineVersions": [
    {
      "versionId": "v1",
      "versionTag": {
        "versionNumber": 3,
        "lastModifiedBy": {
          "login": "demo"
        },
        "lastModifiedOn": 1757544821160
      },
      "creationTag": {
        "versionNumber": 0,
        "lastModifiedBy": {
          "login": "admin"
        },
        "lastModifiedOn": 1741980409527
      },
      "pythonAgentSettings": {
        "codeEnvSelection": {
          "envMode": "INHERIT"
        },
        "dependencies": [],
        "supportsImageInputs": false,
        "dkuProperties": [],
        "maxParallelRequestsPerProcess": 4,
        "containerExecSelection": {
          "containerMode": "INHERIT"
        }
      },
      "pluginAgentSettings": {
        "dkuProperties": [],
        "maxParallelRequestsPerProcess": 4,
        "containerExecSelection": {
          "containerMode": "INHERIT"
        }
      },
      "toolsUsingAgentSettings": {
        "tools": [
          {
            "toolRef": "l4JUkVF",
            "additionalDescription": "Use this tool to get information on a customer based on their id.  The returned information should tell us whether their loan is already approved or if it\u0027s pending, and any other demographic information we have on them."
          },
          {
            "toolRef": "k90bRD8",
            "additionalDescription": "Use this tool to see whether a prospective customer adheres to our loan and credit score policies.  You may need to ask the prospective customer for more information to ascertain adherence."
          },
          {
            "toolRef": "efUCBOj",
            "additionalDescription": "Use this tool to see whether a prospective customer or a customer with a pending application would be likely to default on a loan.  You will need to ask the prospective customer for the right information to score them with this model.  You should be able to look up a customer with a pending application and use the model to determine whether they are likely to default."
          },
          {
            "toolRef": "7ECpori",
            "additionalDescription": "Use this tool to get information on a customer based on their id.  The returned information should tell us whether their loan is already approved or if it\u0027s pending.  This tool should also be able to answer questions about the dataset that could be answered with SQL."
          }
        ],
        "llmId": "openai:OpenAI_Dataiku_SE_Shared:gpt-4o",
        "systemPromptAppend": "This agent should:\n1. act as an expert on our loan and credit scoring policies. \n2. act as an expert on our loan applicants by being able to query a related dataset. \n3. be able to predict whether a prospective loan applicant or a loan applicant with a pending loan  should be approved for a loan by using a predictive model.",
        "completionSettings": {
          "stopSequences": []
        },
        "dkuProperties": [],
        "maxParallelRequestsPerProcess": 4,
        "containerExecSelection": {
          "containerMode": "INHERIT",
          "containerConf": "eks-default"
        }
      },
      "ragllmSettings": {
        "printSources": true,
        "includeContentInSources": true,
        "outputFormat": "SEPARATED",
        "searchInputStrategySettings": {
          "strategy": "RAW_QUERY",
          "rewritePrompt": "When a message requires document retrieval, rewrite it to optimize retrieval from the vector store.\nFocus on clarity, disambiguation, and extracting the core intent.\nOutput only the rewritten query. Do not include comments or tips."
        },
        "retrievalSource": "EMBEDDING",
        "ragSpecificGuardrails": {
          "faithfulnessSettings": {
            "answerOverwrite": "Could not come up with a factual enough answer.",
            "enabled": false,
            "threshold": 0.8,
            "handling": "FAIL"
          },
          "relevancySettings": {
            "answerOverwrite": "Could not come up with a relevant enough answer.",
            "enabled": false,
            "threshold": 0.8,
            "handling": "FAIL"
          },
          "multimodalFaithfulnessSettings": {
            "answerOverwrite": "Could not come up with a factual enough answer.",
            "enabled": false,
            "threshold": 0.8,
            "handling": "FAIL"
          },
          "multimodalRelevancySettings": {
            "answerOverwrite": "Could not come up with a relevant enough answer.",
            "enabled": false,
            "threshold": 0.8,
            "handling": "FAIL"
          }
        },
        "contextMessage": "Use the following pieces of context to answer the question at the end.\nIf you do not know the answer, just say that you do not know, do not try to make up an answer.",
        "enforceDocumentLevelSecurity": false,
        "performFiltering": false,
        "filter": {
          "distinct": false,
          "enabled": false
        },
        "searchType": "SIMILARITY",
        "similarityThreshold": 0.5,
        "maxDocuments": 4,
        "mmrK": 20,
        "mmrDiversity": 0.25,
        "useAdvancedReranking": false,
        "rrfRankConstant": 60,
        "rrfRankWindowSize": 4,
        "sourcesSettings": {
          "snippetFormat": "TEXT",
          "metadataInSources": []
        }
      },
      "quickTestQuery": {
        "messages": [
          {
            "role": "user",
            "content": "Tell me everything you can about customer 96536."
          }
        ],
        "context": {}
      },
      "guardrailsPipelineSettings": {
        "guardrails": []
      }
    }
  ],
  "conditionalOutputs": [],
  "partitioning": {
    "ignoreNonMatchingFile": false,
    "considerMissingRequestedPartitionsAsEmpty": false,
    "dimensions": []
  },
  "flowOptions": {
    "virtualizable": false,
    "rebuildBehavior": "NORMAL",
    "crossProjectBuildBehavior": "DEFAULT",
    "ignoreErrorStatusOnBuild": false
  },
  "metrics": {
    "probes": [],
    "engineConfig": {
      "padRunsWithMetrics": false,
      "hive": {
        "active": true,
        "extraConf": []
      },
      "basic": {},
      "dss": {
        "active": true,
        "selection": {
          "useMemTable": false,
          "filter": {
            "distinct": false,
            "enabled": false
          },
          "partitionSelectionMethod": "ALL",
          "latestPartitionsN": 1,
          "ordering": {
            "enabled": false,
            "rules": []
          },
          "samplingMethod": "FULL",
          "maxRecords": -1,
          "targetRatio": 0.02,
          "ascending": true,
          "withinFirstN": -1,
          "maxReadUncompressedBytes": -1
        }
      },
      "sql": {
        "active": true
      },
      "impala": {
        "active": true
      },
      "spark": {
        "active": true,
        "extraConf": []
      },
      "python": {}
    },
    "displayedState": {
      "partition": "NP",
      "columns": [],
      "metrics": [
        "reporting:BUILD_DURATION"
      ]
    }
  },
  "metricsChecks": {
    "runOnBuild": false,
    "checks": [],
    "displayedState": {
      "partition": "NP",
      "checks": []
    }
  },
  "lastTrainIndex": 1,
  "lastTrainJobId": "",
  "creationTag": {
    "versionNumber": 0,
    "lastModifiedBy": {
      "login": "admin"
    },
    "lastModifiedOn": 1741980409527
  },
  "tags": [],
  "customFields": {},
  "checklists": {
    "checklists": []
  }
}